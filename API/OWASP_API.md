# OWASP API CHECKLIST
------------------------------------------------------------------
    DOCUMENT CONTROL                          

    NOTE : This Checklist is Referenced from Payatu API E-Book      
------------------------------------------------------------------

## API1:2023 Broken Object Level Authorization

1. API TRUSTS THE OBJECT IDs PROVIDED BY THE CLIENT
   - Verify whether the API relies solely on the object IDs supplied by the client without performing additional authorization checks.
   - Test the API’s response when providing different object IDs, including those that may not be associated with the user’s authorized access.
2. EASILY ENUMERABLE/GUESSABLE OBJECT IDENTIFIERS
    - Assess the API’s resilience against enumeration attacks by attempting to guess or systematically enumerate object IDs.
    - Observe the API’s behavior when supplying object IDs sequentially or using predictable patterns
3. UNAUTHORIZED ACCESS TO RESTRICTED DATA OBJECTS
    - Attempt to access data objects that the user is not authorized to retrieve.
    - Evaluate the API’s response when requesting data for objects that fall outside the user’s authorized scope.
------------------------------------------------------------------ 
## API2:2023 Broken Authentication 

1. ACCESSIBILITY OF UNAUTHORIZED ENDPOINTS
   - Verify if API endpoints that are not intended to be public or accessible by anyone are indeed restricted and inaccessible to unauthorized users.
   - Test the API’s response when attempting to access these endpoints without proper authentication and authorization.
2. ACCEPTANCE OF UNSIGNED/EXPIRED/ WEAKLY SIGNED ACCESS TOKENS
   - Verify the API’s behavior when presented with unsigned, expired, or weakly signed access tokens such as JSON Web Tokens (JWTs).
   - Assess if the API properly rejects such tokens.
3. WEAK ENCRYPTION AND PASSWORD HASHING
   - Evaluate the strength of encryption algorithms and password hashing mechanisms, if possible, during the testing.
   - Test the resilience of the API against known weaknesses, such as weak encryption algorithms or weakly hashed passwords.
   - Check JavaScript files for exposed encryption secrets and functions and try to use it to craft payloads
------------------------------------------------------------------
## API3:2023 Broken Object Property Level Authorization 

1. VERIFY PROPERTY LEVEL AUTHORIZATION
   - Test scenarios where users have access to an object but should not have access to specific properties within the object.
   - Attempt to access and modify properties that should be restricted or limited to certain user roles or privileges.
   - Validate that the API correctly enforces property level authorization preventing unauthorized access and modification.
2. ASSESS PROPER FILTERING OF OBJECT PROPERTIES IN RESPONSES
   - Examine the API’s responses and ensure that only authorized properties are included in the returned data.
   - Test scenarios where the API mistakenly exposes restricted properties potentially revealing sensitive or confidential information.
   - Verify that the API correctly filters out unnecessary and unauthorized properties and provides only the necessary and authorized data to users.
3. EVALUATE COMPLEX OBJECT STRUCTURES
   - Test scenarios involving complex object structures with nested properties and sub-properties.
   - An object with such complexity will have higher chances of being vulnerable to this type of attack.
   - Verify that the API correctly handles authorization checks at each level of the object hierarchy.
------------------------------------------------------------------
## API4:2023 Unrestricted Resource Consumption

1. TEST EXCESSIVE REQUEST RATE
   - Test different scenarios to check whether the API allows users to send huge number of requests in a short interval of time.
   - Check if the API has appropriate rate-limiting mechanisms to prevent overwhelming the server and exhaustion of resources.
2. VALIDATE PAYLOAD SIZE LIMITATIONS
   - Send requests with large payloads to assess if the API enforces size restrictions.
   - Verify that the API rejects excessively large payloads and responds with appropriate error messages.
3. ASSESS RESOURCE UTILIZATION
   - In a white box approach, monitor the API’s resource consumption, such as CPU, memory, network, and storage, during normal operation and under different load conditions.
   - Evaluate how the API scales and manages resource allocation to prevent resource exhaustion and ensure efficient resource utilization
------------------------------------------------------------------
## API5:2023 Broken Function Level Authorization 

1. TEST MANIPULATION OF HTTP VERBS AND PATHS
   - Attempt to change normal HTTP verbs (eg: POST => PATCH, PUT) to assess if unauthorized access to sensitive API functionalities is possible.
   - Explore the API endpoints by modifying the path value such as changing context from user (`/api/v1/user`) to admin (`/api/v1/admin`) to identify any unintended access or privilege escalation
2. EVALUATE NONPRIVILEGED ACCESS TO SENSITIVE API FUNCTIONALITIES
   - Using non-privileged users, attempt to access sensitive API functionalities that should be restricted to specific roles or privileged accounts.
3. ASSESS EXPLOITATION OF RESOURCE RETRIEVAL FUNCTIONALITIES
   - Perform tests for SSRF, LFI, path traversal vulnerabilities to manipulate the API to obtain unauthorized access to data.
------------------------------------------------------------------
## API6:2023 Unrestricted Access to Sensitive Business Flows

1. VALIDATE ACCESS RESTRICTIONS ON SENSITIVE BUSINESS FLOWS
   - Test the API’s endpoints that involve critical business flows to ensure proper access controls are in place.
   - Test for replay attacks on sensitive business flows.
2. EVALUATE RATE LIMITING AND THROTTLING MECHANISMS
   - Test the API’s rate limiting and throttling mechanisms to ensure they effectively prevent excessive access to sensitive business flows.
   - Send a high volume of requests within a short period to determine if the API enforces rate limits and throttles access accordingly.
   - Check if there is appropriate spam control in place to prevent spamming.
 ------------------------------------------------------------------ 
 ## API7:2023  Server-Side Request Forgery 

 1. TEST VALIDATION OF USERSUPPLIED URLs
    - Attempt to provide manipulated URLs, including variations in protocols such as `ftp://`, `file://`, local IP addresses, or private network addresses.
    - Verify if the API properly validates and restricts usersupplied URLs, preventing unauthorized requests to internal or external resources
2. ASSESS BYPASSING NETWORK SECURITY PROTOCOLS
    - Attempt to exploit SSRF by forcing the API to send requests to unexpected destinations.
3. EVALUATE ACCESS TO INTERNAL RESOURCES
    - Probe the API to assess if it allows access to internal resources or sensitive endpoints within the infrastructure.
    - Attempt to retrieve data or perform operations on internal systems, such as accessing databases, or interacting with administrative interfaces.
4. ASSESS INDIRECT IMPACT AND CHAINABLE VULNERABILITIES
    - Explore the potential impact of SSRF by chaining it with other vulnerabilities to increase the attack impact.
    - Assess if any information obtained via the SSRF can be used to further escalate into any other attack.
------------------------------------------------------------------
## API8:2023  Security Misconfiguration 

1. REVIEW CONFIGURATION SETTINGS
    - Assess the API framework or platform default configuration settings to ensure they are secure by default.
    - Identify and address any potentially insecure configurations that could lead to security vulnerabilities.
2. TEST ERROR HANDLING AND LOGGING
    - Assess the API’s error handling mechanism to ensure that error messages do not disclose sensitive information such as system details or user data.
    - Validate that error messages are appropriately logged and monitored to facilitate timely detection and response to potential security incidents.
3. REVIEW ENCRYPTION AND TRANSPORT SECURITY
    - Evaluate the API’s encryption protocols and transport security measures such as TLS/SSL configurations, to ensure the confidentiality and integrity of data in transit.
    - Test for potential weaknesses or misconfigurations in encryption algorithms, key management, or certificate validation.
------------------------------------------------------------------
## API9:2023 Improper Inventory Management 

1. TEST FOR DIFFERENT VERSIONS OF THE API
   - For example, if an API endpoint looks like `/api/v3/ users`, we may try other endpoints such as `/api/v1/ users` or `/api/v2/users`. .
   - We may also use subdomain discovery to identify different publicly accessible environments of the API. If the API runs at `api.example.com`, we may get a subdomain for `api-dev.example.com`.
2. TEST FOR API DOCUMENTATION INACCURACIES
    - While going through documentation, we may find some endpoints removed in the latest API version but were present previously.
    - We can try the same endpoints that were removed in the documentation on the latest API version to check if it was actually removed from the API or only removed in the documentation.
    - Being an older API endpoint, it may be vulnerable to some attacks.
 3. EVALUATE DATA INTEGRATION AND SYNCHRONIZATION
      - Verify that data synchronization occurs effectively, ensuring that inventory data remains consistent across all the relevant systems.
      - On the dev/testing environment, try registering for a user with an email belonging to an existing user on the production API.
      -  We might be able to take over the user’s original account in production if proper synchronization is not present or if the different environments are not sandboxed from each other.
      -  Check if the testing/development environments are sandboxed and separate from production. The secrets used, for example in session tokens, should be separate from production.
------------------------------------------------------------------
## API10:2023 Unsafe Consumption of APIs 

1. IDENTIFY EXTERNAL INTEGRATIONS SET UP WITH THE API
   - When testing for this vulnerability, try to identify any third-party integrations such as APIs and services
   - Validate that proper security measures are in place, such as secure authentication and data encryption, for all external integrations.
3. REVIEW DATA VALIDATION AND SANITIZATION
    - Send malicious data inputs through the API to assess if the system performs thorough validation and sanitization of potentially malicious data.
    - Verify that the API rejects or sanitizes potentially malicious data to prevent common vulnerabilities such as SQL injection or Cross-Site Scripting (XSS) attacks.
      
5. EVALUATE DATA ENCRYPTION
    - Assess whether the data communicated with the API is sent over encrypted connection.

------------------------------------------------------------------
